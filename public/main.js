'use strict';

var app = angular.module('Meaniscule', ['ui.router', 'ui.bootstrap']);

app.config(function ($urlRouterProvider, $locationProvider) {
   // This turns off hashbang urls (/#about) and changes it to something normal (/about)
   $locationProvider.html5Mode(true);
   // If we go to a URL that ui-router doesn't have registered, go to the "/" url.
   $urlRouterProvider.otherwise('/');
});
'use strict';

app.controller('HomeController', function ($state, $scope, $anchorScroll, TSP, QueryFactory, D3Factory, $location) {
      $scope.requestDone = false;

      $scope.sendQuery = function (query) {
            $scope.requestDone = true;
            $scope.loading = true;
            QueryFactory.sendQuery(query).then(function (response) {
                  console.log('back back back', response);
                  $scope.loading = false;
                  $scope.places = response;
                  QueryFactory.places = response;
                  $scope.length = response.length;
                  $location.hash('coordinates');
                  $anchorScroll();
                  // console.log('first set a coo', response[0].coordinates)
                  D3Factory.clearPlot();
            });
      };

      $scope.getDirections = function (locations) {
            // console.log('hit getDirections', locations)
            // var dataSet = locations.map(function(place){ return place.coordinates })
            var nn = TSP.nearestNeighbor(locations, locations[1].coordinates);
            D3Factory.clearPlot();
            $location.hash('map');
            $anchorScroll();
            D3Factory.showPlots(nn);
            // console.log('these is the output for shortest distance', nn)
      };
});
'use strict';

app.config(function ($stateProvider) {
    $stateProvider.state('home', {
        url: '/',
        templateUrl: '/app/home/home.html',
        controller: 'HomeController'
    });
});
"use strict";

app.directive("navbar", function () {
	return {
		restrict: "E",
		templateUrl: "/app/navbar/navbar.html"
	};
});
'use strict';

var svg;
app.factory('D3Factory', function () {
	var polyLine;
	var map;
	return {
		clearPlot: function clearPlot() {
			console.log('IS IT CLEARING');
			if (svg) {
				map.removeLayer(polyLine);
				svg.selectAll('circle').remove();
			}
		},
		showPlots: function showPlots(dataSet) {
			// initialized map
			if (map) map.setView(dataSet[0].coordinates, 8);else {
				// doesn't
				map = L.map('map').setView(dataSet[0].coordinates, 8);
				var mapLink = '<a href="http://openstreetmap.org">OpenStreetMap</a>';
				L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
					attribution: '&copy; ' + mapLink + ' Contributors',
					maxZoom: 18
				}).addTo(map);
			}

			// Initialize the SVG layer
			map._initPathRoot();

			var test = dataSet.map(function (d) {
				return d.coordinates;
			});
			polyLine = L.polyline(test).addTo(map);

			// We pick up the SVG from the map object
			svg = d3.select('#map').select('svg');
			var g = svg.append('g');

			dataSet.forEach(function (d) {
				d.LatLng = new L.LatLng(d.coordinates[0], d.coordinates[1]);
			});

			var tooltip = d3.select('body').append('div').attr('class', 'tooltip').style('opacity', 0);

			var feature = g.selectAll('circle').data(dataSet).enter().append('circle').style('stroke', 'black').style('fill', 'red').attr('r', 8).on('mouseover', function (d) {
				tooltip.transition().duration(200).style('opacity', 0.9);
				tooltip.html('<h5>Step: ' + d.step + '</h5><p>' + d.place + ' - ' + d.categories + '</p>').style('left', d3.event.pageX + 5 + 'px').attr('fill', '#215BB8').style('top', d3.event.pageY - 28 + 'px');
			}).on('mouseout', function (d) {
				tooltip.transition().duration(500).style('opacity', 0);
			});

			map.on('viewreset', update);
			update();

			function update() {
				feature.attr('transform', function (d) {
					return 'translate(' + map.latLngToLayerPoint(d.LatLng).x + ',' + map.latLngToLayerPoint(d.LatLng).y + ')';
				});
			}

			// var lat = dataSet.map(function(e){return e.coordinates[0]});
			// var long = dataSet.map(function(e){return e.coordinates[1]});
			// console.log('this be lat long arr', lat, long)

			// var xMax = Math.max.apply(null, lat); // height
			// var xMin = Math.min.apply(null, lat); // width
			// var yMax = Math.max.apply(null, long); // height
			// var yMin = Math.min.apply(null, long); // width

			// var w = 1800;
			// var h = 800;

			// // calculate max/min for x and y here if necessary
			// // var zoom = d3.behavior.zoom()
			// //  			.scaleExtent([1, 10])
			// //  			.on("zoom", zoomed);

			// var xScale = d3.scale.linear()
			//              .domain([xMin, xMax])
			//              .range([0,w]);

			// var yScale = d3.scale.linear()
			//              .domain([yMax, yMin])
			//              .range([0,h]);

			// svg = d3.select("#map")
			//     .append("svg")
			//     // .attr("width", w)
			//     // .attr("height",h)
			//     // .call(zoom)
			//     .append('svg:g')
			//     .attr('transform', 'translate(55,55)')
			//     .style("pointer-events", "all");

			// svg.selectAll("circle")
			//     .data(dataSet)
			//     .enter()
			//     .append("circle")
			//     .attr("cx", function(d) {
			//           return xScale(d.coordinates[0]);
			//     })
			//     .attr("cy", function(d) {
			//           return yScale(d.coordinates[1]);
			//     })
			//     .attr("r",4);

			// var xAxis = d3.svg.axis()
			//     .scale(xScale)
			//     .orient('bottom')
			//     .tickSize(1);

			// var yAxis = d3.svg.axis()
			//     .scale(yScale)
			//     .orient('left')
			//     .tickSize(1);

			// svg.selectAll('text')
			// 	.data(dataSet)
			// 	.enter()
			// 	.append('text')
			// 	.text(function(d){
			// 		return d.place + " - " + d.categories;
			// 	})
			// 	.attr("x", function(d) {
			// 	    return xScale(d.coordinates[0]);
			// 	})
			// 	.attr("y", function(d) {
			// 	   return yScale(d.coordinates[1]);
			// 	})
			// 	.attr("font-family", "sans-serif")
			// 				.attr("font-size", "11px")
			// 				.attr("fill", "red");

			// svg.append("svg:g")
			//     .attr("class", "xaxis")
			//     .attr("transform", "translate(0," + h + ")")
			//     .call(xAxis);

			// svg.append("svg:g")
			//     .attr("class", "yaxis")
			//     .call(yAxis);

			//    function zoomed() {
			// 	svg.attr("transform", "translate(" + d3.event.translate + ")scale(" + d3.event.scale + ")");
			// };
		}
	};
});
'use strict';

app.factory('TSP', function () {
	return {
		nearestNeighbor: function nearestNeighbor(coordinates, start) {
			var count = 0;

			function NearestNeighbor(dataSet, startPoint) {
				this.dataSet = dataSet;
				this.startPoint = startPoint;
				this.nearestK;
				this.output = [];
			}

			NearestNeighbor.prototype.sortByX = function () {
				this.dataSet.sort(function (a, b) {
					return a.coordinates[0] - b.coordinates[0];
				});
				return this;
			};

			NearestNeighbor.prototype.getNearestK = function (k) {
				this.nearestK = this.dataSet.slice(0, k);
				return this;
			};

			NearestNeighbor.prototype.getNN = function () {
				var nearest = this.nextLocation();
				count++;
				nearest.step = count;
				this.output.push(nearest);
				this.startPoint = nearest.coordinates;
			};

			NearestNeighbor.prototype.nextLocation = function () {
				var sortedDistance = this.findDistance(this.nearestK);
				var idxOfNN = sortedDistance.shift().i;

				return this.dataSet.splice(idxOfNN, 1)[0];
			};

			NearestNeighbor.prototype.findDistance = function (arr) {
				var self = this;
				return arr.map(function (coo, idx) {
					var obj = {};
					obj.i = idx;
					obj.coordinates = coo.coordinates;
					obj.distance = self.pythagorean(coo.coordinates[0], coo.coordinates[1]);
					return obj;
				}).sort(function (a, b) {
					return a.distance - b.distance;
				});
			};

			NearestNeighbor.prototype.pythagorean = function (lat, longi) {
				var startX = this.startPoint[0];
				var startY = this.startPoint[1];
				return Math.sqrt(Math.pow(startX - lat, 2) + Math.pow(startY - longi, 2));
			};

			var nn = new NearestNeighbor(coordinates, start);
			var len = coordinates.length;

			for (var i = 0; i < len; i++) {
				nn.sortByX().getNearestK(3).getNN();
			}
			return nn.output;
		}
	};
});
'use strict';

app.factory('QueryFactory', function ($http) {
	return {
		sendQuery: function sendQuery(string) {
			var query = string.replace(/\s+/g, '+');
			console.log('query', query);
			var self = this;
			return $http.get('/api/home/' + query).then(function (response) {
				// self.places = response.data;
				console.log('this is places in sendQuery', self.places);
				return response.data;
			});
		},
		places: null,
		coordinates: function coordinates() {
			return this.places.map(function (place) {
				return place.coordinates;
			});
		}
	};
});
"use strict";

function NearestNeighbor(dataSet, startPoint) {
	this.dataSet = dataSet;
	this.startPoint = startPoint;
	this.nearestK;
	this.output = [];
}

NearestNeighbor.prototype.sortByX = function () {
	this.dataSet.sort(function (a, b) {
		return a[0] - b[0];
	});
	return this;
};

NearestNeighbor.prototype.getNearestK = function (k) {
	this.nearestK = this.dataSet.slice(0, k);
	return this;
};

NearestNeighbor.prototype.getNN = function () {
	var nearest = this.nextLocation();
	this.output.push(nearest);
	this.startPoint = nearest;
};

NearestNeighbor.prototype.nextLocation = function () {
	var sortedDistance = this.findDistance(this.nearestK);
	var idxOfNN = sortedDistance.shift().i;
	return this.dataSet.splice(idxOfNN, 1)[0];
};

NearestNeighbor.prototype.findDistance = function (arr) {
	var self = this;
	return arr.map(function (coo, idx) {
		var obj = {};
		obj.i = idx;
		obj.coordinates = coo;
		obj.distance = self.pythagorean(coo[0], coo[1]);
		return obj;
	}).sort(function (a, b) {
		return a.distance - b.distance;
	});
};

NearestNeighbor.prototype.pythagorean = function (lat, longi) {
	var startX = this.startPoint[0];
	var startY = this.startPoint[1];
	return Math.sqrt(Math.pow(startX - lat, 2) + Math.pow(startY - longi, 2));
};
'use strict';

app.directive('loader', function ($compile) {
    return {
        restrict: 'E',
        template: '<img src="/app/common/directives/loader/plane2.gif" />'
    };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImhvbWUvaG9tZS5jb250cm9sbGVyLmpzIiwiaG9tZS9ob21lLnN0YXRlLmpzIiwibmF2YmFyL25hdmJhci5kaXJlY3RpdmUuanMiLCJjb21tb24vZmFjdG9yaWVzL0QzLmZhY3RvcnkuanMiLCJjb21tb24vZmFjdG9yaWVzL25lYXJlc3QuZmFjdG9yeS5qcyIsImNvbW1vbi9mYWN0b3JpZXMvcXVlcnkuZmFjdG9yeS5qcyIsImNvbW1vbi9qcy9uZWFyZXN0TmVpZ2hib3VyLmpzIiwiY29tbW9uL2RpcmVjdGl2ZXMvbG9hZGVyL2xvYWRlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQUksR0FBRyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsWUFBWSxFQUFFLENBQUMsV0FBVyxFQUFFLGNBQWMsQ0FBQyxDQUFDLENBQUM7O0FBRXRFLEdBQUcsQ0FBQyxNQUFNLENBQUMsVUFBVSxrQkFBa0IsRUFBRSxpQkFBaUIsRUFBRTs7QUFFekQsb0JBQWlCLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDOztBQUVsQyxxQkFBa0IsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7Q0FDcEMsQ0FBQyxDQUFDOzs7QUNQSCxHQUFHLENBQUMsVUFBVSxDQUFDLGdCQUFnQixFQUFFLFVBQVMsTUFBTSxFQUFFLE1BQU0sRUFBRSxhQUFhLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFO0FBQzlHLFlBQU0sQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDOztBQUU1QixZQUFNLENBQUMsU0FBUyxHQUFHLFVBQVMsS0FBSyxFQUFDO0FBQy9CLGtCQUFNLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztBQUM1QixrQkFBTSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7QUFDdEIsd0JBQVksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVMsUUFBUSxFQUFDO0FBQ3BELHlCQUFP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QUFDLFNBQVMsQ0FBQyxXQUFXLEdBQUcsVUFBUyxHQUFHLEVBQUUsS0FBSyxFQUFDO0FBQzNELEtBQUksTUFBTSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDaEMsS0FBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNoQyxRQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxHQUFHLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0NBQzFFLENBQUM7OztBQ2pERixHQUFHLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxVQUFVLFFBQVEsRUFBRTtBQUN4QyxXQUFPO0FBQ0gsZ0JBQVEsRUFBRSxHQUFHO0FBQ2IsZ0JBQVEsRUFBRSx3REFBd0Q7S0FDckUsQ0FBQztDQUNMLENBQUMsQ0FBQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdNZWFuaXNjdWxlJywgWyd1aS5yb3V0ZXInLCAndWkuYm9vdHN0cmFwJ10pO1xuXG5hcHAuY29uZmlnKGZ1bmN0aW9uICgkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAvLyBUaGlzIHR1cm5zIG9mZiBoYXNoYmFuZyB1cmxzICgvI2Fib3V0KSBhbmQgY2hhbmdlcyBpdCB0byBzb21ldGhpbmcgbm9ybWFsICgvYWJvdXQpXG4gICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG4gICAvLyBJZiB3ZSBnbyB0byBhIFVSTCB0aGF0IHVpLXJvdXRlciBkb2Vzbid0IGhhdmUgcmVnaXN0ZXJlZCwgZ28gdG8gdGhlIFwiL1wiIHVybC5cbiAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbn0pOyIsImFwcC5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzdGF0ZSwgJHNjb3BlLCAkYW5jaG9yU2Nyb2xsLCBUU1AsIFF1ZXJ5RmFjdG9yeSwgRDNGYWN0b3J5LCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUucmVxdWVzdERvbmUgPSBmYWxzZTtcblxuICBcdCRzY29wZS5zZW5kUXVlcnkgPSBmdW5jdGlvbihxdWVyeSl7XG4gICAgICAkc2NvcGUucmVxdWVzdERvbmUgPSB0cnVlO1xuICBcdFx0JHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICBcdFx0UXVlcnlGYWN0b3J5LnNlbmRRdWVyeShxdWVyeSkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gIFx0XHRcdGNvbnNvbGUubG9nKCdiYWNrIGJhY2sgYmFjaycsIHJlc3BvbnNlKVxuICBcdFx0XHQkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICBcdFx0XHQkc2NvcGUucGxhY2VzID0gcmVzcG9uc2U7XG4gICAgICAgIFF1ZXJ5RmFjdG9yeS5wbGFjZXMgPSByZXNwb25zZTtcbiAgXHRcdFx0JHNjb3BlLmxlbmd0aCA9IHJlc3BvbnNlLmxlbmd0aDtcbiAgXHRcdFx0JGxvY2F0aW9uLmhhc2goJ2Nvb3JkaW5hdGVzJyk7XG4gICAgICAgICRhbmNob3JTY3JvbGwoKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ2ZpcnN0IHNldCBhIGNvbycsIHJlc3BvbnNlWzBdLmNvb3JkaW5hdGVzKVxuICBcdFx0XHREM0ZhY3RvcnkuY2xlYXJQbG90KCk7XG4gIFx0XHR9KTtcbiAgXHR9O1xuXG4gICAgJHNjb3BlLmdldERpcmVjdGlvbnMgPSBmdW5jdGlvbihsb2NhdGlvbnMpe1xuICAgICAgLy8gY29uc29sZS5sb2coJ2hpdCBnZXREaXJlY3Rpb25zJywgbG9jYXRpb25zKVxuICAgICAgLy8gdmFyIGRhdGFTZXQgPSBsb2NhdGlvbnMubWFwKGZ1bmN0aW9uKHBsYWNlKXsgcmV0dXJuIHBsYWNlLmNvb3JkaW5hdGVzIH0pXG4gICAgICB2YXIgbm4gPSBUU1AubmVhcmVzdE5laWdoYm9yKGxvY2F0aW9ucywgbG9jYXRpb25zWzFdLmNvb3JkaW5hdGVzKTtcbiAgICAgIEQzRmFjdG9yeS5jbGVhclBsb3QoKTtcbiAgICAgICRsb2NhdGlvbi5oYXNoKCdtYXAnKTtcbiAgICAgICRhbmNob3JTY3JvbGwoKTtcbiAgICAgIEQzRmFjdG9yeS5zaG93UGxvdHMobm4pO1xuICAgICAgLy8gY29uc29sZS5sb2coJ3RoZXNlIGlzIHRoZSBvdXRwdXQgZm9yIHNob3J0ZXN0IGRpc3RhbmNlJywgbm4pXG4gICAgfVxuICAgIFxufSk7IiwiYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnaG9tZScsIHtcbiAgICAgICAgdXJsOiAnLycsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9ob21lL2hvbWUuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcidcbiAgICB9KTtcbn0pOyIsImFwcC5kaXJlY3RpdmUoXCJuYXZiYXJcIiwgZnVuY3Rpb24oKXtcblx0cmV0dXJuIHtcblx0XHRyZXN0cmljdDogXCJFXCIsXG5cdFx0dGVtcGxhdGVVcmw6IFwiL2FwcC9uYXZiYXIvbmF2YmFyLmh0bWxcIlxuXHR9O1xufSk7IiwidmFyIHN2ZztcbmFwcC5mYWN0b3J5KCdEM0ZhY3RvcnknLCBmdW5jdGlvbigpe1xuXHR2YXIgcG9seUxpbmVcblx0dmFyIG1hcDtcblx0cmV0dXJuIHtcblx0XHRjbGVhclBsb3Q6IGZ1bmN0aW9uKCl7XG5cdFx0XHRjb25zb2xlLmxvZygnSVMgSVQgQ0xFQVJJTkcnKVxuXHRcdFx0aWYoc3ZnKXtcblx0XHRcdFx0bWFwLnJlbW92ZUxheWVyKHBvbHlMaW5lKVxuXHRcdFx0XHRzdmcuc2VsZWN0QWxsKCdjaXJjbGUnKS5yZW1vdmUoKTtcdFxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0c2hvd1Bsb3RzOiBmdW5jdGlvbihkYXRhU2V0KXtcblx0XHRcdC8vIGluaXRpYWxpemVkIG1hcFxuXHRcdFx0aWYobWFwKSBtYXAuc2V0VmlldyhkYXRhU2V0WzBdLmNvb3JkaW5hdGVzLCA4KTtcblx0XHRcdGVsc2Uge1x0XG5cdFx0XHRcdC8vIGRvZXNuJ3Rcblx0XHRcdFx0bWFwID0gTC5tYXAoJ21hcCcpLnNldFZpZXcoZGF0YVNldFswXS5jb29yZGluYXRlcywgOCk7XG5cdFx0XHRcdHZhciBtYXBMaW5rID0gJzxhIGhyZWY9XCJodHRwOi8vb3BlbnN0cmVldG1hcC5vcmdcIj5PcGVuU3RyZWV0TWFwPC9hPic7XG5cdCAgICAgICBcdFx0TC50aWxlTGF5ZXIoJ2h0dHA6Ly97c30udGlsZS5vcGVuc3RyZWV0bWFwLm9yZy97en0ve3h9L3t5fS5wbmcnLCB7XG5cdCAgICAgICAgICAgIFx0YXR0cmlidXRpb246ICcmY29weTsgJyArIG1hcExpbmsgKyAnIENvbnRyaWJ1dG9ycycsXG5cdCAgICAgICAgICAgIFx0bWF4Wm9vbTogMTgsXG5cdCAgICAgICAgICAgIH0pLmFkZFRvKG1hcCk7XG5cdCAgICAgICBcdH1cblxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgU1ZHIGxheWVyXG5cdFx0XHRtYXAuX2luaXRQYXRoUm9vdCgpICAgIFxuXG5cdFx0XHR2YXIgdGVzdCA9IGRhdGFTZXQubWFwKGZ1bmN0aW9uKGQpe3JldHVybiBkLmNvb3JkaW5hdGVzfSk7XG5cdFx0XHRwb2x5TGluZSA9IEwucG9seWxpbmUodGVzdCkuYWRkVG8obWFwKTtcblxuXHRcdFx0Ly8gV2UgcGljayB1cCB0aGUgU1ZHIGZyb20gdGhlIG1hcCBvYmplY3Rcblx0XHRcdHN2ZyA9IGQzLnNlbGVjdChcIiNtYXBcIikuc2VsZWN0KFwic3ZnXCIpO1xuXHRcdFx0dmFyIGcgPSBzdmcuYXBwZW5kKFwiZ1wiKTtcblxuICAgICAgICAgICAgZGF0YVNldC5mb3JFYWNoKGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgXHRkLkxhdExuZyA9IG5ldyBMLkxhdExuZyhkLmNvb3JkaW5hdGVzWzBdLCBkLmNvb3JkaW5hdGVzWzFdKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2YXIgdG9vbHRpcCA9IGQzLnNlbGVjdChcImJvZHlcIikuYXBwZW5kKFwiZGl2XCIpXG4gICBcdFx0XHRcdC5hdHRyKFwiY2xhc3NcIiwgXCJ0b29sdGlwXCIpXG4gICBcdFx0XHRcdC5zdHlsZShcIm9wYWNpdHlcIiwgMCk7XG5cbiAgICAgICAgICAgIHZhciBmZWF0dXJlID0gZy5zZWxlY3RBbGwoXCJjaXJjbGVcIilcblx0XHRcdFx0LmRhdGEoZGF0YVNldClcblx0XHRcdFx0LmVudGVyKCkuYXBwZW5kKFwiY2lyY2xlXCIpXG5cdFx0XHRcdC5zdHlsZShcInN0cm9rZVwiLCBcImJsYWNrXCIpICAgXG5cdFx0XHRcdC5zdHlsZShcImZpbGxcIiwgXCJyZWRcIilcblx0XHRcdFx0LmF0dHIoXCJyXCIsIDgpXG5cdFx0XHRcdC5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbihkKSB7XG5cdFx0XHQgICAgICAgIHRvb2x0aXAudHJhbnNpdGlvbigpXG5cdFx0XHQgICAgICAgICAgLmR1cmF0aW9uKDIwMClcblx0XHRcdCAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIC45KTtcblx0XHRcdCAgICAgICAgdG9vbHRpcC5odG1sKCc8aDU+U3RlcDogJytkLnN0ZXArJzwvaDU+PHA+JytkLnBsYWNlICsgXCIgLSBcIiArIGQuY2F0ZWdvcmllcysnPC9wPicpXG5cdFx0XHQgICAgICAgICAgLnN0eWxlKFwibGVmdFwiLCAoZDMuZXZlbnQucGFnZVggKyA1KSArIFwicHhcIilcblx0XHRcdCAgICAgICAgICAuYXR0cihcImZpbGxcIiwgJyMyMTVCQjgnKVxuXHRcdCAgICAgICAgICAgLnN0eWxlKFwidG9wXCIsIChkMy5ldmVudC5wYWdlWSAtIDI4KSArIFwicHhcIik7XG5cdCAgICAgXHQgICAgfSlcblx0XHRcdCAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbihkKSB7XG5cdFx0XHQgICAgICAgIHRvb2x0aXAudHJhbnNpdGlvbigpXG5cdFx0XHQgICAgICAgICAgLmR1cmF0aW9uKDUwMClcblx0XHRcdCAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDApO1xuXHRcdFx0ICAgIH0pOyBcblxuXG5cdFx0XHRtYXAub24oXCJ2aWV3cmVzZXRcIiwgdXBkYXRlKTtcblx0XHRcdHVwZGF0ZSgpO1xuXG5cdFx0XHRmdW5jdGlvbiB1cGRhdGUoKSB7XG5cdFx0XHRcdGZlYXR1cmUuYXR0cihcInRyYW5zZm9ybVwiLCBcblx0XHRcdFx0ZnVuY3Rpb24oZCkgeyBcblx0XHRcdFx0XHRyZXR1cm4gXCJ0cmFuc2xhdGUoXCIrIFxuXHRcdFx0XHRcdFx0bWFwLmxhdExuZ1RvTGF5ZXJQb2ludChkLkxhdExuZykueCArXCIsXCIrIFxuXHRcdFx0XHRcdFx0bWFwLmxhdExuZ1RvTGF5ZXJQb2ludChkLkxhdExuZykueSArXCIpXCI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHQpXG5cdFx0XHR9IFxuXG5cdFx0XHRcblxuXHRcdFx0Ly8gdmFyIGxhdCA9IGRhdGFTZXQubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBlLmNvb3JkaW5hdGVzWzBdfSk7XG5cdFx0XHQvLyB2YXIgbG9uZyA9IGRhdGFTZXQubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBlLmNvb3JkaW5hdGVzWzFdfSk7XG5cdFx0XHQvLyBjb25zb2xlLmxvZygndGhpcyBiZSBsYXQgbG9uZyBhcnInLCBsYXQsIGxvbmcpXG5cblx0XHRcdC8vIHZhciB4TWF4ID0gTWF0aC5tYXguYXBwbHkobnVsbCwgbGF0KTsgLy8gaGVpZ2h0XG5cdFx0XHQvLyB2YXIgeE1pbiA9IE1hdGgubWluLmFwcGx5KG51bGwsIGxhdCk7IC8vIHdpZHRoXG5cdFx0XHQvLyB2YXIgeU1heCA9IE1hdGgubWF4LmFwcGx5KG51bGwsIGxvbmcpOyAvLyBoZWlnaHRcblx0XHRcdC8vIHZhciB5TWluID0gTWF0aC5taW4uYXBwbHkobnVsbCwgbG9uZyk7IC8vIHdpZHRoXG5cblx0XHRcdC8vIHZhciB3ID0gMTgwMDtcblx0XHRcdC8vIHZhciBoID0gODAwO1xuXG5cdFx0XHQvLyAvLyBjYWxjdWxhdGUgbWF4L21pbiBmb3IgeCBhbmQgeSBoZXJlIGlmIG5lY2Vzc2FyeVxuXHRcdFx0Ly8gLy8gdmFyIHpvb20gPSBkMy5iZWhhdmlvci56b29tKClcbiAgIC8vIC8vICBcdFx0XHQuc2NhbGVFeHRlbnQoWzEsIDEwXSlcbiAgIC8vIC8vICBcdFx0XHQub24oXCJ6b29tXCIsIHpvb21lZCk7XG5cblx0XHRcdC8vIHZhciB4U2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKVxuXHRcdFx0Ly8gICAgICAgICAgICAgIC5kb21haW4oW3hNaW4sIHhNYXhdKSBcblx0XHRcdC8vICAgICAgICAgICAgICAucmFuZ2UoWzAsd10pO1xuXG5cdFx0XHQvLyB2YXIgeVNjYWxlID0gZDMuc2NhbGUubGluZWFyKClcblx0XHRcdC8vICAgICAgICAgICAgICAuZG9tYWluKFt5TWF4LCB5TWluXSlcblx0XHRcdC8vICAgICAgICAgICAgICAucmFuZ2UoWzAsaF0pO1xuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgXG5cdFx0XHQvLyBzdmcgPSBkMy5zZWxlY3QoXCIjbWFwXCIpXG5cdFx0XHQvLyAgICAgLmFwcGVuZChcInN2Z1wiKVxuXHRcdFx0Ly8gICAgIC8vIC5hdHRyKFwid2lkdGhcIiwgdylcblx0XHRcdC8vICAgICAvLyAuYXR0cihcImhlaWdodFwiLGgpXG5cdFx0XHQvLyAgICAgLy8gLmNhbGwoem9vbSlcblx0XHRcdC8vICAgICAuYXBwZW5kKCdzdmc6ZycpXG5cdFx0XHQvLyAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoNTUsNTUpJylcblx0XHRcdC8vICAgICAuc3R5bGUoXCJwb2ludGVyLWV2ZW50c1wiLCBcImFsbFwiKTtcblxuXHRcdFx0Ly8gc3ZnLnNlbGVjdEFsbChcImNpcmNsZVwiKVxuXHRcdFx0Ly8gICAgIC5kYXRhKGRhdGFTZXQpXG5cdFx0XHQvLyAgICAgLmVudGVyKClcblx0XHRcdC8vICAgICAuYXBwZW5kKFwiY2lyY2xlXCIpXG5cdFx0XHQvLyAgICAgLmF0dHIoXCJjeFwiLCBmdW5jdGlvbihkKSB7XG5cdFx0XHQvLyAgICAgICAgICAgcmV0dXJuIHhTY2FsZShkLmNvb3JkaW5hdGVzWzBdKTsgXG5cdFx0XHQvLyAgICAgfSlcblx0XHRcdC8vICAgICAuYXR0cihcImN5XCIsIGZ1bmN0aW9uKGQpIHtcblx0XHRcdC8vICAgICAgICAgICByZXR1cm4geVNjYWxlKGQuY29vcmRpbmF0ZXNbMV0pOyBcblx0XHRcdC8vICAgICB9KVxuXHRcdFx0Ly8gICAgIC5hdHRyKFwiclwiLDQpOyBcblxuXG5cdFx0XHQvLyB2YXIgeEF4aXMgPSBkMy5zdmcuYXhpcygpXG5cdFx0XHQvLyAgICAgLnNjYWxlKHhTY2FsZSlcblx0XHRcdC8vICAgICAub3JpZW50KCdib3R0b20nKVxuXHRcdFx0Ly8gICAgIC50aWNrU2l6ZSgxKTtcblxuXHRcdFx0Ly8gdmFyIHlBeGlzID0gZDMuc3ZnLmF4aXMoKVxuXHRcdFx0Ly8gICAgIC5zY2FsZSh5U2NhbGUpXG5cdFx0XHQvLyAgICAgLm9yaWVudCgnbGVmdCcpXG5cdFx0XHQvLyAgICAgLnRpY2tTaXplKDEpO1xuXG5cdFx0XHQvLyBzdmcuc2VsZWN0QWxsKCd0ZXh0Jylcblx0XHRcdC8vIFx0LmRhdGEoZGF0YVNldClcblx0XHRcdC8vIFx0LmVudGVyKClcblx0XHRcdC8vIFx0LmFwcGVuZCgndGV4dCcpXG5cdFx0XHQvLyBcdC50ZXh0KGZ1bmN0aW9uKGQpe1xuXHRcdFx0Ly8gXHRcdHJldHVybiBkLnBsYWNlICsgXCIgLSBcIiArIGQuY2F0ZWdvcmllcztcblx0XHRcdC8vIFx0fSlcblx0XHRcdC8vIFx0LmF0dHIoXCJ4XCIsIGZ1bmN0aW9uKGQpIHtcblx0XHRcdC8vIFx0ICAgIHJldHVybiB4U2NhbGUoZC5jb29yZGluYXRlc1swXSk7XG5cdFx0XHQvLyBcdH0pXG5cdFx0XHQvLyBcdC5hdHRyKFwieVwiLCBmdW5jdGlvbihkKSB7XG5cdFx0XHQvLyBcdCAgIHJldHVybiB5U2NhbGUoZC5jb29yZGluYXRlc1sxXSk7XG5cdFx0XHQvLyBcdH0pXG5cdFx0XHQvLyBcdC5hdHRyKFwiZm9udC1mYW1pbHlcIiwgXCJzYW5zLXNlcmlmXCIpXG4gICAvLyBcdFx0XHRcdC5hdHRyKFwiZm9udC1zaXplXCIsIFwiMTFweFwiKVxuICAgLy8gXHRcdFx0XHQuYXR0cihcImZpbGxcIiwgXCJyZWRcIik7XG4gICBcdFx0XHRcblxuXHRcdFx0Ly8gc3ZnLmFwcGVuZChcInN2ZzpnXCIpXG5cdFx0XHQvLyAgICAgLmF0dHIoXCJjbGFzc1wiLCBcInhheGlzXCIpXG5cdFx0XHQvLyAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCxcIiArIGggKyBcIilcIilcblx0XHRcdC8vICAgICAuY2FsbCh4QXhpcyk7XG5cblx0XHRcdC8vIHN2Zy5hcHBlbmQoXCJzdmc6Z1wiKVxuXHRcdFx0Ly8gICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJ5YXhpc1wiKVxuXHRcdFx0Ly8gICAgIC5jYWxsKHlBeGlzKTtcblxuXHRcdCAvLyAgICBmdW5jdGlvbiB6b29tZWQoKSB7XG5cdFx0XHQvLyBcdHN2Zy5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgZDMuZXZlbnQudHJhbnNsYXRlICsgXCIpc2NhbGUoXCIgKyBkMy5ldmVudC5zY2FsZSArIFwiKVwiKTtcblx0XHRcdC8vIH07XG5cblx0XHR9XG5cdH1cbn0pXG5cbiIsImFwcC5mYWN0b3J5KCdUU1AnLCBmdW5jdGlvbigpe1xuXHRyZXR1cm4ge1xuXHRcdG5lYXJlc3ROZWlnaGJvcjogZnVuY3Rpb24oY29vcmRpbmF0ZXMsIHN0YXJ0KXtcblx0XHRcdHZhciBjb3VudCA9IDA7XG5cblx0XHRcdGZ1bmN0aW9uIE5lYXJlc3ROZWlnaGJvcihkYXRhU2V0LCBzdGFydFBvaW50KXtcblx0XHRcdFx0dGhpcy5kYXRhU2V0ID0gZGF0YVNldDsgXG5cdFx0XHRcdHRoaXMuc3RhcnRQb2ludCA9IHN0YXJ0UG9pbnQ7IFxuXHRcdFx0XHR0aGlzLm5lYXJlc3RLO1xuXHRcdFx0XHR0aGlzLm91dHB1dCA9IFtdO1xuXHRcdFx0fVxuXG5cdFx0XHROZWFyZXN0TmVpZ2hib3IucHJvdG90eXBlLnNvcnRCeVggPSBmdW5jdGlvbigpe1xuXHRcdFx0XHR0aGlzLmRhdGFTZXQuc29ydChmdW5jdGlvbihhLGIpeyBcblx0XHRcdFx0XHRyZXR1cm4gYS5jb29yZGluYXRlc1swXSAtIGIuY29vcmRpbmF0ZXNbMF1cblx0XHRcdFx0fSk7IFxuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH07XG5cblx0XHRcdE5lYXJlc3ROZWlnaGJvci5wcm90b3R5cGUuZ2V0TmVhcmVzdEsgPSBmdW5jdGlvbihrKXtcblx0XHRcdFx0dGhpcy5uZWFyZXN0SyA9IHRoaXMuZGF0YVNldC5zbGljZSgwLGspOyBcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9O1xuXG5cblx0XHRcdE5lYXJlc3ROZWlnaGJvci5wcm90b3R5cGUuZ2V0Tk4gPSBmdW5jdGlvbigpe1xuXHRcdFx0XHR2YXIgbmVhcmVzdCA9IHRoaXMubmV4dExvY2F0aW9uKCk7XG5cdFx0XHRcdGNvdW50Kys7XG5cdFx0XHRcdG5lYXJlc3Quc3RlcCA9IGNvdW50O1xuXHRcdFx0XHR0aGlzLm91dHB1dC5wdXNoKG5lYXJlc3QpO1xuXHRcdFx0XHR0aGlzLnN0YXJ0UG9pbnQgPSBuZWFyZXN0LmNvb3JkaW5hdGVzO1xuXHRcdFx0fTtcblxuXHRcdFx0TmVhcmVzdE5laWdoYm9yLnByb3RvdHlwZS5uZXh0TG9jYXRpb24gPSBmdW5jdGlvbigpe1xuXHRcdFx0XHR2YXIgc29ydGVkRGlzdGFuY2UgPSB0aGlzLmZpbmREaXN0YW5jZSh0aGlzLm5lYXJlc3RLKTtcblx0XHRcdFx0dmFyIGlkeE9mTk4gPSBzb3J0ZWREaXN0YW5jZS5zaGlmdCgpLmk7IFxuXG5cdFx0XHRcdHJldHVybiB0aGlzLmRhdGFTZXQuc3BsaWNlKGlkeE9mTk4sIDEpWzBdO1xuXHRcdFx0fTtcblxuXHRcdFx0TmVhcmVzdE5laWdoYm9yLnByb3RvdHlwZS5maW5kRGlzdGFuY2UgPSBmdW5jdGlvbihhcnIpe1xuXHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdHJldHVybiBhcnIubWFwKGZ1bmN0aW9uKGNvbywgaWR4KXtcblx0XHRcdFx0XHR2YXIgb2JqID0ge307XG5cdFx0XHRcdFx0b2JqLmkgPSBpZHg7XG5cdFx0XHRcdFx0b2JqLmNvb3JkaW5hdGVzID0gY29vLmNvb3JkaW5hdGVzO1xuXHRcdFx0XHRcdG9iai5kaXN0YW5jZSA9IHNlbGYucHl0aGFnb3JlYW4oY29vLmNvb3JkaW5hdGVzWzBdLCBjb28uY29vcmRpbmF0ZXNbMV0pO1xuXHRcdFx0XHRcdHJldHVybiBvYmo7XHRcblx0XHRcdFx0fSkuc29ydChmdW5jdGlvbihhLGIpeyBcblx0XHRcdFx0XHRyZXR1cm4gYS5kaXN0YW5jZSAtIGIuZGlzdGFuY2U7IFxuXHRcdFx0XHR9KTtcblx0XHRcdH07XG5cblx0XHRcdE5lYXJlc3ROZWlnaGJvci5wcm90b3R5cGUucHl0aGFnb3JlYW4gPSBmdW5jdGlvbihsYXQsIGxvbmdpKXtcblx0XHRcdFx0dmFyIHN0YXJ0WCA9IHRoaXMuc3RhcnRQb2ludFswXTtcblx0XHRcdFx0dmFyIHN0YXJ0WSA9IHRoaXMuc3RhcnRQb2ludFsxXTtcblx0XHRcdFx0cmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyhzdGFydFggLSBsYXQsIDIpICsgTWF0aC5wb3coc3RhcnRZIC0gbG9uZ2ksIDIpKTtcblx0XHRcdH07XG5cblx0XHRcdHZhciBubiA9IG5ldyBOZWFyZXN0TmVpZ2hib3IoY29vcmRpbmF0ZXMsIHN0YXJ0KTtcblx0XHRcdHZhciBsZW4gPSBjb29yZGluYXRlcy5sZW5ndGg7XG5cdFx0XHRcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKyl7XG5cdFx0XHRcdG5uLnNvcnRCeVgoKS5nZXROZWFyZXN0SygzKS5nZXROTigpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG5uLm91dHB1dDtcblxuXHRcdH1cblx0fVxuXG59KSIsImFwcC5mYWN0b3J5KCdRdWVyeUZhY3RvcnknLCBmdW5jdGlvbigkaHR0cCl7XG5cdHJldHVybntcblx0XHRzZW5kUXVlcnk6IGZ1bmN0aW9uKHN0cmluZyl7XG5cdFx0XHR2YXIgcXVlcnkgPSBzdHJpbmcucmVwbGFjZSgvXFxzKy9nLCBcIitcIik7XG5cdFx0XHRjb25zb2xlLmxvZygncXVlcnknLCBxdWVyeSk7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2hvbWUvJysgcXVlcnkpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuXHRcdFx0XHQvLyBzZWxmLnBsYWNlcyA9IHJlc3BvbnNlLmRhdGE7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCd0aGlzIGlzIHBsYWNlcyBpbiBzZW5kUXVlcnknLCBzZWxmLnBsYWNlcylcblx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlLmRhdGE7XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdHBsYWNlczogbnVsbCxcblx0XHRjb29yZGluYXRlczogZnVuY3Rpb24oKXtcblx0XHRcdHJldHVybiB0aGlzLnBsYWNlcy5tYXAoZnVuY3Rpb24ocGxhY2Upe3JldHVybiBwbGFjZS5jb29yZGluYXRlc30pXG5cdFx0fVxuXHR9O1xufSk7XG5cbiIsImZ1bmN0aW9uIE5lYXJlc3ROZWlnaGJvcihkYXRhU2V0LCBzdGFydFBvaW50KXtcblx0dGhpcy5kYXRhU2V0ID0gZGF0YVNldDsgXG5cdHRoaXMuc3RhcnRQb2ludCA9IHN0YXJ0UG9pbnQ7IFxuXHR0aGlzLm5lYXJlc3RLO1xuXHR0aGlzLm91dHB1dCA9IFtdO1xufVxuXG5OZWFyZXN0TmVpZ2hib3IucHJvdG90eXBlLnNvcnRCeVggPSBmdW5jdGlvbigpe1xuXHR0aGlzLmRhdGFTZXQuc29ydChmdW5jdGlvbihhLGIpeyBcblx0XHRyZXR1cm4gYVswXSAtIGJbMF1cblx0fSk7IFxuXHRyZXR1cm4gdGhpcztcbn07XG5cbk5lYXJlc3ROZWlnaGJvci5wcm90b3R5cGUuZ2V0TmVhcmVzdEsgPSBmdW5jdGlvbihrKXtcblx0dGhpcy5uZWFyZXN0SyA9IHRoaXMuZGF0YVNldC5zbGljZSgwLGspOyBcblx0cmV0dXJuIHRoaXM7XG59O1xuXG5cbk5lYXJlc3ROZWlnaGJvci5wcm90b3R5cGUuZ2V0Tk4gPSBmdW5jdGlvbigpe1xuXHR2YXIgbmVhcmVzdCA9IHRoaXMubmV4dExvY2F0aW9uKCk7XG5cdHRoaXMub3V0cHV0LnB1c2gobmVhcmVzdCk7XG5cdHRoaXMuc3RhcnRQb2ludCA9IG5lYXJlc3Q7XG59O1xuXG5OZWFyZXN0TmVpZ2hib3IucHJvdG90eXBlLm5leHRMb2NhdGlvbiA9IGZ1bmN0aW9uKCl7XG5cdHZhciBzb3J0ZWREaXN0YW5jZSA9IHRoaXMuZmluZERpc3RhbmNlKHRoaXMubmVhcmVzdEspO1xuXHR2YXIgaWR4T2ZOTiA9IHNvcnRlZERpc3RhbmNlLnNoaWZ0KCkuaTsgXG5cdHJldHVybiB0aGlzLmRhdGFTZXQuc3BsaWNlKGlkeE9mTk4sIDEpWzBdO1xufTtcblxuTmVhcmVzdE5laWdoYm9yLnByb3RvdHlwZS5maW5kRGlzdGFuY2UgPSBmdW5jdGlvbihhcnIpe1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cdHJldHVybiBhcnIubWFwKGZ1bmN0aW9uKGNvbywgaWR4KXtcblx0XHR2YXIgb2JqID0ge307XG5cdFx0b2JqLmkgPSBpZHg7XG5cdFx0b2JqLmNvb3JkaW5hdGVzID0gY29vO1xuXHRcdG9iai5kaXN0YW5jZSA9IHNlbGYucHl0aGFnb3JlYW4oY29vWzBdLCBjb29bMV0pO1xuXHRcdHJldHVybiBvYmo7XHRcblx0fSkuc29ydChmdW5jdGlvbihhLGIpeyBcblx0XHRyZXR1cm4gYS5kaXN0YW5jZSAtIGIuZGlzdGFuY2U7IFxuXHR9KTtcbn07XG5cbk5lYXJlc3ROZWlnaGJvci5wcm90b3R5cGUucHl0aGFnb3JlYW4gPSBmdW5jdGlvbihsYXQsIGxvbmdpKXtcblx0dmFyIHN0YXJ0WCA9IHRoaXMuc3RhcnRQb2ludFswXTtcblx0dmFyIHN0YXJ0WSA9IHRoaXMuc3RhcnRQb2ludFsxXTtcblx0cmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyhzdGFydFggLSBsYXQsIDIpICsgTWF0aC5wb3coc3RhcnRZIC0gbG9uZ2ksIDIpKTtcbn07XG4iLCJhcHAuZGlyZWN0aXZlKCdsb2FkZXInLCBmdW5jdGlvbiAoJGNvbXBpbGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0ZW1wbGF0ZTogJzxpbWcgc3JjPVwiL2FwcC9jb21tb24vZGlyZWN0aXZlcy9sb2FkZXIvcGxhbmUyLmdpZlwiIC8+J1xuICAgIH07XG59KTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==